{"ast":null,"code":"var _jsxFileName = \"/Users/davit/Desktop/Asociation/client/src/adminpanel/components/UploadWidget/UploadWidget.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport styles from './UploadWidget.module.scss';\nimport Loading from '../Loading/Loading';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function UploadWidget({\n  setData,\n  title,\n  value,\n  name = 'cover'\n}) {\n  _s();\n  const [imageUrl, setImageUrl] = useState('');\n  const [load, setLoad] = useState(false);\n\n  // თუ არსებობს value, მაშინ თავიდანვე შევინახოთ არსებული გამოსახულება\n  useEffect(() => {\n    if (value) {\n      setImageUrl(value); // წინასწარ გამოჩნდება ბლოგის არსებული ფოტო\n    }\n  }, [value]);\n  const handleChange = async e => {\n    const selectedFile = e.target.files[0];\n    if (!selectedFile) return;\n    setLoad(true);\n    const formData = new FormData();\n    formData.append('image', selectedFile);\n    try {\n      const res = await axios.post(`${process.env.REACT_APP_API_URL}/upload/image`, formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      });\n      setImageUrl(res.data.url); // განახლებული გამოსახულება\n\n      setData(prev => ({\n        ...prev,\n        [name]: res.data.url // ახალ URL-ის შენახვა `cover`-ში\n      }));\n      setLoad(false);\n    } catch (err) {\n      console.error('Upload error:', err);\n      alert('Upload failed');\n      setLoad(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.uploadwidget,\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      children: title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      onChange: handleChange,\n      className: styles.uploadwidget__input\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 13\n    }, this), load && /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 22\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.uploadwidget__cover,\n      children: imageUrl && /*#__PURE__*/_jsxDEV(\"img\", {\n        src: imageUrl,\n        alt: \"Uploaded\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 30\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 46,\n    columnNumber: 9\n  }, this);\n}\n_s(UploadWidget, \"Pwy4lFqU1f3fYTu0UvgFFgT6uUY=\");\n_c = UploadWidget;\nvar _c;\n$RefreshReg$(_c, \"UploadWidget\");","map":{"version":3,"names":["React","useState","useEffect","axios","styles","Loading","jsxDEV","_jsxDEV","UploadWidget","setData","title","value","name","_s","imageUrl","setImageUrl","load","setLoad","handleChange","e","selectedFile","target","files","formData","FormData","append","res","post","process","env","REACT_APP_API_URL","headers","data","url","prev","err","console","error","alert","className","uploadwidget","children","fileName","_jsxFileName","lineNumber","columnNumber","type","onChange","uploadwidget__input","uploadwidget__cover","src","alt","_c","$RefreshReg$"],"sources":["/Users/davit/Desktop/Asociation/client/src/adminpanel/components/UploadWidget/UploadWidget.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport styles from './UploadWidget.module.scss';\nimport Loading from '../Loading/Loading';\n\nexport default function UploadWidget({ setData, title, value, name = 'cover' }) {\n    const [imageUrl, setImageUrl] = useState('');\n    const [load, setLoad] = useState(false);\n\n    // თუ არსებობს value, მაშინ თავიდანვე შევინახოთ არსებული გამოსახულება\n    useEffect(() => {\n        if (value) {\n            setImageUrl(value); // წინასწარ გამოჩნდება ბლოგის არსებული ფოტო\n        }\n    }, [value]);\n\n    const handleChange = async (e) => {\n        const selectedFile = e.target.files[0];\n        if (!selectedFile) return;\n\n        setLoad(true);\n        const formData = new FormData();\n        formData.append('image', selectedFile);\n\n        try {\n            const res = await axios.post(`${process.env.REACT_APP_API_URL}/upload/image`, formData, {\n                headers: {\n                    'Content-Type': 'multipart/form-data',\n                },\n            });\n\n            setImageUrl(res.data.url); // განახლებული გამოსახულება\n\n            setData((prev) => ({\n                ...prev,\n                [name]: res.data.url, // ახალ URL-ის შენახვა `cover`-ში\n            }));\n            setLoad(false);\n        } catch (err) {\n            console.error('Upload error:', err);\n            alert('Upload failed');\n            setLoad(false);\n        }\n    };\n    return (\n        <div className={styles.uploadwidget}>\n            <p>{title}</p>\n            <input type=\"file\" onChange={handleChange} className={styles.uploadwidget__input} />\n            {load && <Loading />}\n            <div className={styles.uploadwidget__cover}>\n                {imageUrl && <img src={imageUrl} alt=\"Uploaded\" />}\n            </div>\n        </div>\n    );\n}\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,MAAM,MAAM,4BAA4B;AAC/C,OAAOC,OAAO,MAAM,oBAAoB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEzC,eAAe,SAASC,YAAYA,CAAC;EAAEC,OAAO;EAAEC,KAAK;EAAEC,KAAK;EAAEC,IAAI,GAAG;AAAQ,CAAC,EAAE;EAAAC,EAAA;EAC5E,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGd,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACe,IAAI,EAAEC,OAAO,CAAC,GAAGhB,QAAQ,CAAC,KAAK,CAAC;;EAEvC;EACAC,SAAS,CAAC,MAAM;IACZ,IAAIS,KAAK,EAAE;MACPI,WAAW,CAACJ,KAAK,CAAC,CAAC,CAAC;IACxB;EACJ,CAAC,EAAE,CAACA,KAAK,CAAC,CAAC;EAEX,MAAMO,YAAY,GAAG,MAAOC,CAAC,IAAK;IAC9B,MAAMC,YAAY,GAAGD,CAAC,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;IACtC,IAAI,CAACF,YAAY,EAAE;IAEnBH,OAAO,CAAC,IAAI,CAAC;IACb,MAAMM,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;IAC/BD,QAAQ,CAACE,MAAM,CAAC,OAAO,EAAEL,YAAY,CAAC;IAEtC,IAAI;MACA,MAAMM,GAAG,GAAG,MAAMvB,KAAK,CAACwB,IAAI,CAAC,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,eAAe,EAAEP,QAAQ,EAAE;QACpFQ,OAAO,EAAE;UACL,cAAc,EAAE;QACpB;MACJ,CAAC,CAAC;MAEFhB,WAAW,CAACW,GAAG,CAACM,IAAI,CAACC,GAAG,CAAC,CAAC,CAAC;;MAE3BxB,OAAO,CAAEyB,IAAI,KAAM;QACf,GAAGA,IAAI;QACP,CAACtB,IAAI,GAAGc,GAAG,CAACM,IAAI,CAACC,GAAG,CAAE;MAC1B,CAAC,CAAC,CAAC;MACHhB,OAAO,CAAC,KAAK,CAAC;IAClB,CAAC,CAAC,OAAOkB,GAAG,EAAE;MACVC,OAAO,CAACC,KAAK,CAAC,eAAe,EAAEF,GAAG,CAAC;MACnCG,KAAK,CAAC,eAAe,CAAC;MACtBrB,OAAO,CAAC,KAAK,CAAC;IAClB;EACJ,CAAC;EACD,oBACIV,OAAA;IAAKgC,SAAS,EAAEnC,MAAM,CAACoC,YAAa;IAAAC,QAAA,gBAChClC,OAAA;MAAAkC,QAAA,EAAI/B;IAAK;MAAAgC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eACdtC,OAAA;MAAOuC,IAAI,EAAC,MAAM;MAACC,QAAQ,EAAE7B,YAAa;MAACqB,SAAS,EAAEnC,MAAM,CAAC4C;IAAoB;MAAAN,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,EACnF7B,IAAI,iBAAIT,OAAA,CAACF,OAAO;MAAAqC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eACpBtC,OAAA;MAAKgC,SAAS,EAAEnC,MAAM,CAAC6C,mBAAoB;MAAAR,QAAA,EACtC3B,QAAQ,iBAAIP,OAAA;QAAK2C,GAAG,EAAEpC,QAAS;QAACqC,GAAG,EAAC;MAAU;QAAAT,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACjD,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACL,CAAC;AAEd;AAAChC,EAAA,CAjDuBL,YAAY;AAAA4C,EAAA,GAAZ5C,YAAY;AAAA,IAAA4C,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}